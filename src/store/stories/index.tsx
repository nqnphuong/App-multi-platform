import {createAsyncThunk, createSlice} from '@reduxjs/toolkit';
import {IStoryByUser} from 'models/Story';
import PostApi from '../../../api/post/request';

const userStories = [
  {
    id: 1,
    username: 'Alan',
    title: 'Albums',
    profile:
      'https://banner2.cleanpng.com/20190606/xch/kisspng-faded-music-mask-disc-jockey-darkside-5cf8dd7baf38c5.5844290115598134997177.jpg',
    stories: [
      {
        id: 1,
        url: 'https://i1.sndcdn.com/artworks-IrhmhgPltsdrwMu8-thZohQ-t500x500.jpg',
        type: 'image',
        duration: 3,
        isReadMore: true,
        storyId: 1,
        isSeen: false,
      },
      {
        id: 2,
        url: 'https://res.cloudinary.com/wonder-place/video/upload/v1683732889/video/Snaptik.app_7231055026414832901_terkkg.mp4',
        type: 'video',
        duration: 15,
        isReadMore: true,
        storyId: 1,
        isSeen: false,
      },
      {
        id: 3,
        url: 'https://res.cloudinary.com/wonder-place/video/upload/v1683732889/video/Snaptik.app_7231055026414832901_terkkg.mp4',
        type: 'video',
        duration: 15,
        isReadMore: true,
        storyId: 1,
        isSeen: false,
      },
    ],
  },
  {
    id: 2,
    username: 'Weekend',
    profile:
      'https://sosugary.com/wp-content/uploads/2022/01/TheWeeknd_001.jpg',
    title: 'Album Launch',
    stories: [
      {
        id: 0,
        url: 'https://i.scdn.co/image/ab67616d0000b273e7f02e8d0f955f39758186ae',
        type: 'image',
        duration: 5,
        isReadMore: true,
        storyId: 2,
        isSeen: false,
      },
      {
        id: 1,
        url: 'https://static.wixstatic.com/media/f7b73f_4749adcf2ece4708889c960d1da3fda6~mv2_d_1800_1800_s_2.png/v1/fill/w_1800,h_1800,al_c,q_90/file.jpg',
        type: 'image',
        duration: 10,
        isReadMore: true,
        storyId: 2,
        isSeen: false,
      },
    ],
  },
  {
    id: 3,
    username: 'Selena',
    profile:
      'https://assets.teenvogue.com/photos/589dcce16d33d9e97bc045d2/16:9/w_2560%2Cc_limit/GettyImages-587593904.jpg',
    title: 'Albums',
    stories: [
      {
        id: 0,
        url: 'https://static.wikia.nocookie.net/selenagomez/images/c/c4/Stars_Dance_Standard.jpg/revision/latest?cb=20160510194715',
        type: 'image',
        duration: 5,
        isReadMore: true,
        storyId: 3,
        isSeen: false,
      },
      {
        id: 1,
        url: 'https://www.selenagomez.com/sites/g/files/aaj10001/f/styles/suzuki_breakpoints_image_mobile-lg_sq/public/release/202203/ab67616d0000b273b69a2033d72a130888a227a1.jpg?itok=lWC-TVwE',
        type: 'image',
        duration: 10,
        isReadMore: true,
        storyId: 3,
        isSeen: false,
      },
    ],
  },
  {
    id: 4,
    username: 'Shakira',
    profile:
      'https://ichef.bbci.co.uk/news/976/cpsprodpb/9A9B/production/_116497593_gettyimages-971720370.jpg',
    title: 'Albums',
    stories: [
      {
        id: 0,
        url: 'https://i.discogs.com/xCYSQK3tBLUJqmoqi08VLPBCIPMX1J-TKSaohDaOwFc/rs:fit/g:sm/q:90/h:491/w:486/czM6Ly9kaXNjb2dz/LWRhdGFiYXNlLWlt/YWdlcy9SLTQ3NDM3/MjAtMTM3NDA5ODE4/Ny05MDYyLmpwZWc.jpeg',
        type: 'image',
        duration: 5,
        isReadMore: true,
        storyId: 4,
        isSeen: false,
      },
      {
        id: 1,
        url: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS-amD7xS8_-BzQbfUSRiPx8ciTEg34PMJpfg&usqp=CAU',
        type: 'image',
        duration: 10,
        isReadMore: true,
        storyId: 4,
        isSeen: false,
      },
    ],
  },
  {
    id: 5,
    username: "K'naan",
    profile:
      'https://m.media-amazon.com/images/M/MV5BM2Q0NmVjZmEtZTJlNS00NGQ5LTkxYzAtODk5ZmI2MTZkZWMzXkEyXkFqcGdeQXVyMjA4OTI5NDQ@._V1_.jpg',
    title: 'Single Album',
    stories: [
      {
        id: 0,
        url: 'https://cdns-images.dzcdn.net/images/cover/1fc68087a940ef86d9c304e39e6fa4c5/500x500.jpg',
        type: 'image',
        duration: 5,
        isReadMore: true,
        storyId: 4,
        isSeen: false,
      },
    ],
  },
];

export interface IStoriesState {
  stories: IStoryByUser[];
  isStoryViewVisible: boolean;
  pressedIndex: number;
}

const initialState: IStoriesState = {
  stories: userStories,
  isStoryViewVisible: false,
  pressedIndex: 0,
};

const slice = createSlice({
  name: 'stories',
  initialState,
  reducers: {
    setIsStoryViewShow(state, action) {
      state.isStoryViewVisible = action.payload;
    },
    setPressedIndex(state, action) {
      state.pressedIndex = action.payload;
    },
  },
  extraReducers(builder) {},
});

const getPosts = createAsyncThunk('stories/getStories', async () => {
  try {
    const myPostRes = await PostApi.getMyPosts();
    const postRes = await PostApi.getPosts();
    return [...myPostRes.data.data, ...postRes.data.data];
  } catch (error: any) {
    throw new Error(error);
  }
});

export const StoryAction = {
  ...slice.actions,
};

export const storiesSelector = (state: {stories: IStoriesState}) => {
  return state.stories;
};

export default slice.reducer;
